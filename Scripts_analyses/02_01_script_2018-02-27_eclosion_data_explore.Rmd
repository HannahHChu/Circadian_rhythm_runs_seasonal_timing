---
title: "2018-02-27_eclosion_summaries"
output:
  pdf_document: 
    highlight: monochrome
    toc: yes
  html_document: default
---

# Eclosion data 

```{r}
library(data.table)
library(ggplot2)
library(dplyr)
```

## Loading in the data

```{r}
##grabbing data if git cloned
#eclosions<-fread("../Data/2018-01-26_rhagoletis_masterdata_data_slice.csv")
#grabbing from online
eclosions<-fread("../Data/2018-04-26_rhagoletis_masterdata_data_slice.csv")

head(eclosions,10)
names(eclosions)
dim(eclosions)
#tail(eclosions,10)


### getting numbers for eclosions without simulated overwintering, so these pupae were left at rearing temperature
t1<-eclosions%>%
  filter(eclosion_days>1)%>%
  group_by(Host,organism,treatment)%>%
  summarise(counts=length(eclosion_days))
t1

knitr::kable(t1)

#2018-04-26 notes
#there is a apple host with no orgnaism
#eclosions%>%
 # filter(eclosion_days>1 & organism =="")%>%
  #select(uniqueID)
#eclosed on 2017-11-30; nb 002 pg 19; designating as a fly; it eclosed but died same day

#Sample missing treatment 
#eclosions%>%
 # filter(eclosion_days>1 & Host == "Apple"&organism=="fly",treatment=="")%>%
  #select(uniqueID)
  
  
```

## plotting distributions with Ggplot

```{r}
#histogram
treat.filt<-eclosions%>%
  filter(treatment!="" & treatment !="GC" & treatment !="F1"&organism!="")

#ggplot(treat.filt,aes(x=eclosion_days,fill=paste(Host,organism)))+geom_histogram(position="identity",alpha=.52)
ggplot(treat.filt,aes(x=eclosion_days,fill=paste(Host,organism)))+geom_density(position="identity",alpha=.52)+facet_grid(treatment~organism)

ggplot(treat.filt,aes(x=eclosion_days,fill=paste(Host)))+geom_histogram(position="identity",alpha=.52)+facet_grid(treatment~organism)+xlab("Eclosion(days)")


#density of flies only
#flies<-subset(eclosions,organism=="fly")
flies<-eclosions%>%
  filter(treatment!="" & treatment !="GC" & treatment !="F1"&organism=="fly")

ggplot(flies,aes(x=eclosion_days,fill=paste(Host)))+geom_density(position="identity",alpha=.52)+facet_grid(treatment~.)

ggplot(flies,aes(x=eclosion_days,fill=paste(Host)))+geom_histogram(position="identity",alpha=.52)+facet_grid(treatment~.)

##instead of plotting distributions, let's plot averages

ggplot(treat.filt,aes(y=eclosion_days,x=Host))+geom_boxplot()+facet_grid(treatment~organism,scales="free")+ylab("Eclosion (days)")
#lets try some stats

#on the flies only dataset
mod1<-aov(eclosion_days~Host*treatment,data=flies)
summary(mod1)


##simulated overwintering
ap.ks<-subset(flies,Host=="Apple"&treatment=="SO")
haw.ks<-subset(flies,Host=="Haw"&treatment=="SO")
ks.test(ap.ks$eclosion_days,haw.ks$eclosion_days)

###Rearing temperature
rtap.ks<-subset(flies,Host=="Apple"&treatment=="RT")
rthaw.ks<-subset(flies,Host=="Haw"&treatment=="RT")
ks.test(rtap.ks$eclosion_days,rthaw.ks$eclosion_days)

```

# Skipped eclosion data

1. Load in the data from skipped cohorts 
  * Use this link: https://raw.githubusercontent.com/adnguyen/Circadian_rhythm_runs_seasonal_timing/master/Data/2017-10-22_skipped_apple_cohort_eclosions.csv
  
2. Plot (using ggplot) a histogram of eclosion_days 

```{r}

skipped<-fread("https://raw.githubusercontent.com/adnguyen/Circadian_rhythm_runs_seasonal_timing/master/Data/2017-10-22_skipped_apple_cohort_eclosions.csv")


str(skipped)

ggplot(skipped,aes(x=Eclosion_day,fill=Host))+geom_histogram(position="identity",alpha=.5)
ggplot(skipped,aes(x=Eclosion_day,fill=Host))+geom_density(position="identity",alpha=.5)
```



